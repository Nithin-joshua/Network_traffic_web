<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Network Traffic Analyzer</title>
<link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
<header>
  <h1>Network Traffic Analyzer</h1>
</header>

<main>
  <section>
    <h2>What is a Network Traffic Analyzer?</h2>
    <p>
      A Network Traffic Analyzer is a tool that monitors, captures, and analyzes network traffic in real-time.
      It helps identify the types of data packets, measure bandwidth usage, and detect unusual or malicious activities on the host system.
      This project demonstrates a simple analyzer with real-time monitoring and a simulated attack mode.
    </p>
  </section>

  <section>
    <h2>Bandwidth Usage</h2>
    <canvas id="bandwidthChart"></canvas>
  </section>

  <section>
    <h2>Simulated Attack Mode</h2>
    <button id="startBtn">Start Attack</button>
    <button id="stopBtn">Stop Attack</button>
    <p>Host Status: <span id="status">Normal</span></p>
  </section>
</main>

<footer>
  Â© Project by Vinay M Sankaratti
</footer>

<script>
const bandwidthCtx = document.getElementById('bandwidthChart').getContext('2d');
const bandwidthChart = new Chart(bandwidthCtx, {
    type: 'line',
    data: {
        labels: [],
        datasets: [
            { label: 'Upload', data: [], borderColor: '#36A2EB', fill: false },
            { label: 'Download', data: [], borderColor: '#FF6384', fill: false }
        ]
    }
});

function updateCharts() {
    fetch('/api/traffic').then(r=>r.json()).then(data => {
        bandwidthChart.data.labels.push(data.timestamp);
        bandwidthChart.data.datasets[0].data.push(data.upload);
        bandwidthChart.data.datasets[1].data.push(data.download);

        if (bandwidthChart.data.labels.length > 20) {
            bandwidthChart.data.labels.shift();
            bandwidthChart.data.datasets[0].data.shift();
            bandwidthChart.data.datasets[1].data.shift();
        }
        bandwidthChart.update();

        document.getElementById('status').textContent = data.attack ? "Malicious Activity Detected" : "Normal";
    });
}

setInterval(updateCharts, 1000);

document.getElementById('startBtn').addEventListener('click', () => {
    fetch('/api/attack', {
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify({ mode: "on" })
    });
});

document.getElementById('stopBtn').addEventListener('click', () => {
    fetch('/api/attack', {
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify({ mode: "off" })
    });
});
</script>

</body>
</html>
